<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Joltorongo Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f2f3f8;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      color: #4b2e83;
      margin: 20px 0 10px;
    }
    .toolbar {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin: 10px auto;
      padding: 10px;
    }
    .toolbar input, .toolbar select, .toolbar button {
      padding: 10px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    .toolbar button {
      background-color: #4b2e83;
      color: white;
      cursor: pointer;
    }
    .toolbar button:hover {
      background-color: #3a2165;
    }
    .analytics {
      text-align: center;
      margin: 10px 0;
      font-weight: bold;
    }
    .container {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 10px;
    }
    .card {
      background: white;
      border-radius: 12px;
      padding: 15px;
      margin: 10px;
      width: 350px;
      box-shadow: 0 6px 12px rgba(0,0,0,0.1);
      transition: transform 0.2s;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .card:hover {
      transform: scale(1.02);
    }
    .card h3 {
      margin: 0;
      color: #333;
    }
    .card p {
      margin: 4px 0;
      font-size: 14px;
    }
    .card img {
      max-width: 100%;
      margin-top: 10px;
      border-radius: 6px;
    }
    .delete-btn {
      background-color: crimson;
      color: white;
      padding: 6px 10px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .action-btn {
      background-color: #4b2e83;
      margin-left: 5px;
    }
    .label {
      background: #e2e8f0;
      display: inline-block;
      padding: 3px 8px;
      margin: 2px 0;
      border-radius: 4px;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>Joltorongo Admin Panel</h1>  <div class="toolbar">
    <select id="filterRoomType">
      <option value="">All Room Types</option>
      <option>Economy Queen Deluxe (Ground Floor, No View)</option>
      <option>Executive King Deluxe (Sea View)</option>
      <option>Panoramic Suite (Sea View)</option>
      <!-- Add other room types here -->
    </select>
    <input type="date" id="startDate" placeholder="From" />
    <input type="date" id="endDate" placeholder="To" />
    <button onclick="applyFilter()">Search</button>
    <button onclick="exportToExcel()">Export to Excel</button>
    <button onclick="window.print()">Print All</button>
  </div>  <div class="analytics" id="analytics"></div>
  <div class="container" id="cardContainer"></div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBfW5tyaRjCOWM8OAzKFJmgWR075YBw7Ig",
      authDomain: "hotel-maneger.firebaseapp.com",
      databaseURL: "https://hotel-maneger-default-rtdb.firebaseio.com",
      projectId: "hotel-maneger",
      storageBucket: "hotel-maneger.appspot.com",
      messagingSenderId: "146279207135",
      appId: "1:146279207135:web:93dcc7e2ddf70208a1196a"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let allData = [];
    const cardContainer = document.getElementById("cardContainer");

    db.ref("checkins").on("value", (snapshot) => {
      allData = [];
      snapshot.forEach(child => allData.push(child.val()));
      displayData(allData);
    });

    function displayData(data) {
      cardContainer.innerHTML = "";
      const roomTypeCount = {};

      data.forEach(d => {
        const card = document.createElement("div");
        card.className = "card";
        const uniqueId = "card-" + d.reservation;

        card.innerHTML = `
          <div id="${uniqueId}">
            <h3>${d.guestName || "Unknown Guest"}</h3>
            <p><span class='label'>Reservation:</span> ${d.reservation}</p>
            <p><span class='label'>Room:</span> ${d.roomType}</p>
            ${[1,2,3,4,5,6].map(i => d['multiRoom'+i] ? `<p><span class='label'>Multi Room ${i}:</span> ${d['multiRoom'+i]}</p>` : '').join('')}
            <p><span class='label'>Arrival:</span> ${d.arrival}</p>
            <p><span class='label'>Departure:</span> ${d.departure}</p>
            <p><span class='label'>Mobile:</span> ${d.mobile}</p>
            <p><span class='label'>DOB:</span> ${d.dob || ""}</p>
            <p><span class='label'>Nationality:</span> ${d.nationality}</p>
            <p><span class='label'>NID:</span> ${d.nid}</p>
            <p><span class='label'>Passport:</span> ${d.passport}</p>
            <p><span class='label'>City:</span> ${d.city}</p>
            <p><span class='label'>Company:</span> ${d.company}</p>
            <p><span class='label'>Extra Bed:</span> ${d.extraBed}</p>
            <p><span class='label'>Adult:</span> ${d.adult}, <span class='label'>Infant:</span> ${d.infant}</p>
            <p><span class='label'>Payment Mode:</span> ${d.paymentMode}</p>
            ${d.address ? `<p><span class='label'>Address:</span> ${d.address}</p>` : ''}
            ${d.idFront ? `<img src="${d.idFront}" alt="ID Front"/>` : ''}
            ${d.idBack ? `<img src="${d.idBack}" alt="ID Back"/>` : ''}
            ${d.signature ? `<img src="${d.signature}" alt="Signature"/>` : ''}
          </div>
          <button class="delete-btn" onclick="deleteGuest('${d.reservation}')">Delete</button>
          <button class="delete-btn action-btn" onclick="printSingle('${uniqueId}')">üñ®Ô∏è Print This</button>
        `;

        cardContainer.appendChild(card);

        if (d.roomType) roomTypeCount[d.roomType] = (roomTypeCount[d.roomType] || 0) + 1;
      });

      document.getElementById("analytics").innerText =
        Object.entries(roomTypeCount).map(([k,v]) => `${k}: ${v}`).join(" | ") || "No data";
    }

    function applyFilter() {
      const type = document.getElementById("filterRoomType").value;
      const start = new Date(document.getElementById("startDate").value);
      const end = new Date(document.getElementById("endDate").value);

      const filtered = allData.filter(d => {
        const matchRoom = !type || d.roomType === type;
        const matchDate = (!isNaN(start) && !isNaN(end)) ?
          (new Date(d.arrival) >= start && new Date(d.arrival) <= end) : true;
        return matchRoom && matchDate;
      });
      displayData(filtered);
    }

    function exportToExcel() {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(allData);
      XLSX.utils.book_append_sheet(wb, ws, "CheckIns");
      XLSX.writeFile(wb, "Joltorongo_Checkins.xlsx");
    }

    function deleteGuest(reservation) {
      if (confirm("Are you sure you want to delete this record?")) {
        db.ref("checkins/" + reservation).remove().then(() => {
          alert("Deleted successfully");
        });
      }
    }

    function printSingle(id) {
      const original = document.body.innerHTML;
      const printContent = document.getElementById(id).innerHTML;
      document.body.innerHTML = `<div style='padding:20px'>${printContent}</div>`;
      window.print();
      document.body.innerHTML = original;
      location.reload();
    }
  </script></body>
</html>
